export PYTHONPATH=$(pwd)
export HF_HOME=/vlm/huggingface
# model_path="checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-huge-patch14-448-wo-ocr-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes"
# model_path="checkpoints/llavanext-_vlm_pretrain_models_InternViT-300M-448px-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k_plain"
# model_path="checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-huge-patch14-448-3700000-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/checkpoint-5770"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-huge-patch14-448-3500000-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/checkpoint-3000"
# model_path="checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_mlcd-vit-bigG-patch14-448-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-huge-patch14-448-wo-ocr-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes"
# model_path="checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-378-v0-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-336-v0-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes"
# model_path="./checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-448-v0-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes"
# model_path="./checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-378-v1-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-560-v1-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-560-v2-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/checkpoint-6000"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-bigG-patch14-560-v0-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/checkpoint-3000"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_aimv2-large-patch14-native-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/checkpoint-3000"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-bigG-patch14-560-v0-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_mlcd-vit-bigG-patch14-448-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-bigG-patch14-560-v2-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/"
# model_path="checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-560-v1-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-14nodes-4x4/"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-bigG-patch14-560-v2-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-14nodes-plus"
# 
# model_path="/vlm/xiangan/unicom_unit/checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-560-v1-wo-class-token_-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/checkpoint-2000"
# model_path="checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-560-v1-_vlm_pretrain_models_Qwen_Qwen2.5-3B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/checkpoint-3500"
# model_path="/vlm/xiangan/unicom_unit/checkpoints/emova_llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-560-v1-_vlm_pretrain_models_Qwen_Qwen2.5-3B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-14nodes/checkpoint-11500"

# model_path="checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-560-v1-_vlm_pretrain_models_Qwen_Qwen2.5-3B-Instruct-patch_merger-pretrain_blip558k-emova-alignment-7m-finetune_llavanext780k-14nodes-4x4/"
# model_path="checkpoints/LLaVA-OV-_vlm_xiangan_pretrain_models_deepglint_rice-vit-large-patch14-560-v1-_vlm_pretrain_models_Qwen_Qwen2.5-3B-Instruct-patch_merger-Align-EMOVA3.5M-Finetune-OV3.5M-14nodes-4x4/"
model_path="/vlm/xiangan/checkpoints_rice_vl/emova-_vlm_xiangan_pretrain_models_deepglint_rice-vit-bigG-patch14-560-v2-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-patch_merger-pretrain_7M_vqa_stage_1_5/checkpoint-9000"
model_path="/vlm/xiangan/checkpoints_rice_vl/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-bigG-patch14-560-v2-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-patch_merger-pretrain_blip558k-emova-alignment-7m-finetune_llavanext780k-14nodes-4x4/checkpoint-6000"

model_path="checkpoints/llavanext-_vlm_xiangan_pretrain_models_deepglint_rice-vit-bigG-patch14-560-v2-align-from-emova-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-mlp2x_gelu-pretrain_blip558k-finetune_llavanext780k-8nodes/"
model_path="/vlm/xiangan/checkpoints_rice_vl/llava-one-vision-_vlm_xiangan_pretrain_models_deepglint_rice-vit-bigG-patch14-560-v2-_vlm_pretrain_models_Qwen_Qwen2.5-7B-Instruct-patch_merger-pretrain_blip558k-emova-alignment-7m-finetune_llavanext780k-14nodes-4x4/"

conv_template='qwen_1_5'
run_port=12444
model_name='RICE'


# infovqa,ai2d,gqa,livexiv_vqa_v1,pope,scienceqa_img,mmstar,realworldqa
# infovqa,ai2d,gqa,livexiv_vqa_v1,pope,scienceqa_img,mmstar,realworldqa
# chartqa,docvqa,textvqa,mmbench
# infovqa,chartqa,docvqa,textvqa,ocrbench,livexiv_vqa_v1,ai2d,gqa,mmbench,pope,scienceqa_img,mmstar,realworldqa

CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python -m accelerate.commands.launch \
    --main_process_port=$run_port \
    --num_processes=8 \
    -m lmms_eval \
    --model llava \
    --model_args pretrained=$model_path,conv_template=$conv_template \
    --batch_size 1 \
    --tasks mmbench \
    --log_samples \
    --log_samples_suffix $model_name \
    --output_path ./eval_log/ 


